<!DOCTYPE html>
<html>

<body>

  <h1 align="center">Web Crypto API TestWebsite für Regel 1</h1>
  <p>Test auf einhaltung der Regel im bei einem einfachen Aufruf der Web Crypto API</p>
  <br>
  <br>
  <button id="test1">Test 1</button>
  <P>Hier wird in den Verschlüsselungs-Modi #AES-CTR, #AES-GCM und #AES-CBC die window.crypto.getRandomValues() direkt aufgerufen. 
    Dies wird jeweilt in über die then() Methode und über eine async Funktion getan. Das Ergebnis sollte entsprechend eine Einhaltung der Regel sein.</P>
  <br>
  <br>
  <button id="test2">Test 2</button>
  <p>Hier wird einmal der IV als globale Variable initialisiert und dann in der then()-Methode und in einer async Funktion bei den Verschlüsselungs-Modi #AES-CBC und #AES-GCM 
    verwendet. Außerdem wird in einer async Funktion ein IV initialisiert, der dann beim Verschlüsselungs-Modi #AES-CTR verwendet wird.
     Das Ergebnis sollte entsprechend eine Einhaltung der Regel sein</p>
  <br>
  <br>
  <button id = "test3">Test 3</button>
  <p>Hier wird getestet ob erkannt wird das der IV Wert von einem Funktionscall kommt. Außerdem wird getestet ob die if-else Varianten alle überprüft werden. 
  Bei der zweiten Funktion sollte erkannt werden, dass es hier eine Möglichkeit gibt, bei der der IV nicht als window.crypto.getRandomValues() initialisiert werden kann. 
  entsprechend sollte hier ein Fehler angezeigt werden.</p>
  <br>
  <br>
  <button id = "test4"> Test 4</button>
  <p>Hier wird getestet, ob die Extension erkennt wenn der IV als Parameter der Funktion übergeben wird und dies auch korrekt nachverfolgen kann.</p>
  <br>
  <br>
  <button id = "test5"> Test 5</button>
  <p></p>
  <br>
  <br>
  <button id = "test6"> Test 6</button>
  <p></p>
  <br>
  <br>
  <button id = "testAll"> Test All</button>
  <p></p>
  <br>
  <br>


  <script>
    let rand = window.crypto.getRandomValues(new Uint8Array(16));
    let test1 = document.getElementById("test1");
    let test2 = document.getElementById("test2");
    let test3 = document.getElementById("test3");
    let test4 = document.getElementById("test4");
    let test5 = document.getElementById("test5");
    let test6 = document.getElementById("test6");
    let testAll = document.getElementById("testAll");

    function delay(time) {
      return new Promise(resolve => setTimeout(resolve, time));
    }

    test1.addEventListener("click", Test1);
    async function Test1() {
      let script1 = document.createElement("script");
      script1.src = "test1.js";
      try {
        document.head.removeChild(document.scripts[0]);
      }
      catch (e) {
        console.log(e);
      }
      await delay(1000);
      document.head.appendChild(script1);
    }

    test2.addEventListener("click", Test2);
    async function Test2() {
      let script2 = document.createElement("script");
      script2.src = "test2.js";
      try {
        document.head.removeChild(document.scripts[0]);
      }
      catch (e) {
        console.log(e);
      }
      await delay(1000);
      document.head.appendChild(script2);
    }

    test3.addEventListener("click", Test3);
    async function Test3() {
      let script3 = document.createElement("script");
      script3.src = "test3.js";
      try {
        document.head.removeChild(document.scripts[0]);
      }
      catch (e) {
        console.log(e);
      }
      await delay(1000);
      document.head.appendChild(script3);
    }

    test4.addEventListener("click", Test4);
    async function Test4() {
      let script4 = document.createElement("script");
      script4.src = "test4.js";
      try {
        document.head.removeChild(document.scripts[0]);
      }
      catch (e) {
        console.log(e);
      }
      await delay(1000);
      document.head.appendChild(script4);
    }

    test5.addEventListener("click", Test5);
    async function Test5() {
      let script5 = document.createElement("script");
      script5.src = "test5.js";
      try {
        document.head.removeChild(document.scripts[0]);
      }
      catch (e) {
        console.log(e);
      }
      await delay(1000);
      document.head.appendChild(script5);
    }

    test6.addEventListener("click", Test1);
    async function Test6() {
      let script6 = document.createElement("script");
      script6.src = "test6.js";
      try {
        document.head.removeChild(document.scripts[0]);
      }
      catch (e) {
        console.log(e);
      }
      await delay(1000);
      document.head.appendChild(script6);
    }

    testAll.addEventListener("click", TestAll);
    async function TestAll() {
      Test1();
      Test2();
      Test3();
      Test4();
      Test5();
      Test6();
    } 

  </script>


</body>

</html>